<div class="statistics-container">
  <h2>Travel Trends and Statistics</h2>

  <div *ngIf="loading" class="loading-indicator">Loading statistics...</div>

  <div *ngIf="error" class="error-alert">
    {{ error }}
  </div>

  <div *ngFor="let place of getPlaceStats()" class="chart-bar">
    <div class="bar-label">{{ place.place }}</div>
    <div class="bar" [style.width.%]="(place.count / getMaxPlaceCount()) * 100">
      <span class="bar-value">{{ place.count }}</span>
    </div>
  </div>
</div>

<div class="stat-card">
  <h3>Age Distribution</h3>
  <div class="age-stats">
    <div class="age-summary">
      <div class="age-stat">
        <span class="stat-label">Average Age:</span>
        <span class="stat-value">{{
          statistics.age_stats.mean.toFixed(1)
        }}</span>
      </div>
      <div class="age-stat">
        <span class="stat-label">Age Range:</span>
        <span class="stat-value"
          >{{ statistics.age_stats.min }} - {{ statistics.age_stats.max }}</span
        >
      </div>
    </div>
    <div class="age-groups">
      <h4>Top Destinations by Age Group</h4>

      <div class="age-group">
        <h5>Ages 18-30</h5>
        <ol class="top-places">
          <li *ngFor="let place of getTopPlacesByAgeGroup('18-30')">
            {{ place.place }} ({{ place.count }})
          </li>
        </ol>
      </div>

      <div class="age-group">
        <h5>Ages 31-45</h5>
        <ol class="top-places">
          <li *ngFor="let place of getTopPlacesByAgeGroup('31-45')">
            {{ place.place }} ({{ place.count }})
          </li>
        </ol>
      </div>

      <div class="age-group">
        <h5>Ages 46-60</h5>
        <ol class="top-places">
          <li *ngFor="let place of getTopPlacesByAgeGroup('46-60')">
            {{ place.place }} ({{ place.count }})
          </li>
        </ol>
      </div>

      <div class="age-group">
        <h5>Ages 60+</h5>
        <ol class="top-places">
          <li *ngFor="let place of getTopPlacesByAgeGroup('60+')">
            {{ place.place }} ({{ place.count }})
          </li>
        </ol>
      </div>
    </div>
  </div>
</div>

<div *ngFor="let item of getRatingStats()" class="rating-bar">
  <div class="rating-label">{{ item.rating }}/5</div>
  <div class="bar" [style.width.%]="(item.count / getMaxRatingCount()) * 100">
    <span class="bar-value">{{ item.count }}</span>
  </div>
</div>
