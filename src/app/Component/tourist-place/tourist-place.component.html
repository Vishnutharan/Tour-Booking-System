<div class="container mt-4">
  <h2>Tourist Places</h2>

  <!-- List View -->
  <div *ngIf="!isEditing" class="mb-4">
    <button class="btn btn-primary mb-3" (click)="startAdd()">
      Add New Place
    </button>
    <table class="table">
      <thead>
        <tr>
          <th>Place Name</th>
          <th>Country</th>
          <th>Cost</th>
          <th>Rating</th>
          <th>Hotel</th>
          <th>Guide</th>
          <th>Actions</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let place of places">
          <td>{{ place.placeName }}</td>
          <td>{{ place.countryId }}</td>
          <td>{{ place.cost }}</td>
          <td>{{ place.rating }}</td>
          <td>{{ place.hotelName }}</td>
          <td>{{ place.guideName }}</td>
          <td>
            <button class="btn btn-sm btn-info me-2" (click)="startEdit(place)">
              Edit
            </button>
            <button
              class="btn btn-sm btn-danger"
              (click)="deletePlace(place.placeId)"
            >
              Delete
            </button>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <!-- Form View -->
  <div *ngIf="isEditing">
    <h3>{{ editingId ? "Edit" : "Add" }} Tourist Place</h3>
    <form [formGroup]="form" (ngSubmit)="onSubmit()" class="row g-3">
      <!-- Basic Information -->
      <div class="col-md-6">
        <label class="form-label">Place Name*</label>
        <input type="text" class="form-control" formControlName="placeName" />
      </div>

      <div class="col-md-6">
        <label class="form-label">Country*</label>
        <input type="text" class="form-control" formControlName="countryId" />
      </div>

      <div class="col-12">
        <label class="form-label">Description</label>
        <textarea
          class="form-control"
          formControlName="description"
          rows="3"
        ></textarea>
      </div>

      <!-- Image Upload -->
      <div class="col-12">
        <label class="form-label">Image</label>
        <input
          type="file"
          class="form-control"
          (change)="onFileSelected($event)"
          accept="image/*"
        />
        <img
          *ngIf="form.get('imageUrl')?.value"
          [src]="form.get('imageUrl')?.value"
          class="mt-2"
          style="max-width: 200px"
        />
      </div>

      <!-- Basic Details -->
      <div class="col-md-4">
        <label class="form-label">Cost*</label>
        <input type="number" class="form-control" formControlName="cost" />
      </div>

      <div class="col-md-4">
        <label class="form-label">Rating*</label>
        <input
          type="number"
          class="form-control"
          formControlName="rating"
          min="1"
          max="5"
        />
      </div>

      <div class="col-md-4">
        <label class="form-label">Best Time to Visit</label>
        <input
          type="text"
          class="form-control"
          formControlName="bestTimeToVisit"
        />
      </div>

      <div class="col-md-6">
        <label class="form-label">Duration</label>
        <input type="text" class="form-control" formControlName="duration" />
      </div>

      <!-- Hotel Information -->
      <div class="col-12">
        <h4 class="mt-3">Hotel Details</h4>
      </div>

      <div class="col-md-6">
        <label class="form-label">Hotel Name</label>
        <input type="text" class="form-control" formControlName="hotelName" />
      </div>

      <div class="col-md-6">
        <label class="form-label">Room Type</label>
        <input type="text" class="form-control" formControlName="roomType" />
      </div>

      <div class="col-md-4">
        <label class="form-label">Check-in Date</label>
        <input type="date" class="form-control" formControlName="checkInDate" />
      </div>

      <div class="col-md-4">
        <label class="form-label">Check-out Date</label>
        <input
          type="date"
          class="form-control"
          formControlName="checkOutDate"
        />
      </div>

      <div class="col-md-4">
        <label class="form-label">Number of Rooms</label>
        <input
          type="number"
          class="form-control"
          formControlName="numberOfRooms"
        />
      </div>

      <div class="col-12">
        <label class="form-label">Special Requests</label>
        <textarea
          class="form-control"
          formControlName="specialRequests"
        ></textarea>
      </div>

      <!-- Guide Information -->
      <div class="col-12">
        <h4 class="mt-3">Guide Details</h4>
      </div>

      <div class="col-md-6">
        <label class="form-label">Guide Name*</label>
        <input type="text" class="form-control" formControlName="guideName" />
      </div>

      <div class="col-md-6">
        <label class="form-label">Experience*</label>
        <input type="text" class="form-control" formControlName="experience" />
      </div>

      <div class="col-md-6">
        <label class="form-label">Contact Number*</label>
        <input
          type="text"
          class="form-control"
          formControlName="contactNumber"
        />
      </div>

      <!-- Transportation -->
      <div class="col-12">
        <h4 class="mt-3">Transportation Details</h4>
      </div>

      <div class="col-md-4">
        <label class="form-label">Transportation Mode</label>
        <input
          type="text"
          class="form-control"
          formControlName="transportationMode"
        />
      </div>

      <div class="col-md-4">
        <label class="form-label">Travel Duration</label>
        <input
          type="text"
          class="form-control"
          formControlName="travelDuration"
        />
      </div>

      <div class="col-md-4">
        <label class="form-label">Travel Cost</label>
        <input
          type="number"
          class="form-control"
          formControlName="travelCost"
        />
      </div>

      <!-- Arrays -->
      <div class="col-md-6">
        <label class="form-label">Highlights (comma-separated)</label>
        <input
          type="text"
          class="form-control"
          [value]="form.get('highlights')?.value?.join(',')"
          (input)="updateArray($event, 'highlights')"
        />
      </div>

      <div class="col-md-6">
        <label class="form-label">Languages Spoken (comma-separated)</label>
        <input
          type="text"
          class="form-control"
          [value]="form.get('languagesSpoken')?.value?.join(',')"
          (input)="updateArray($event, 'languagesSpoken')"
        />
      </div>

      <div class="col-12">
        <label class="form-label">Specializations (comma-separated)</label>
        <input
          type="text"
          class="form-control"
          [value]="form.get('specialization')?.value?.join(',')"
          (input)="updateArray($event, 'specialization')"
        />
      </div>

      <!-- Form Actions -->
      <div class="col-12 mt-4">
        <button
          type="submit"
          class="btn btn-primary me-2"
          [disabled]="!form.valid"
        >
          Save
        </button>
        <button type="button" class="btn btn-secondary" (click)="cancelEdit()">
          Cancel
        </button>
      </div>
    </form>
  </div>
</div>
